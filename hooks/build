#!/bin/bash
set -e

docker build -t $IMAGE_NAME .

CONTEXTS="
java
node
node-kafka
node-kafka-cache
toil
"

for CONTEXT in $CONTEXTS; do

  CONTEXT_IMAGE_NAME=$(echo -n $IMAGE_NAME | sed "s|:|:$CONTEXT-|")

  docker build -t yolean/$CONTEXT -t $CONTEXT_IMAGE_NAME ./$CONTEXT
  docker push $CONTEXT_IMAGE_NAME
done
